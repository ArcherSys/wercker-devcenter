# Build this in the wercker ruby box
box: wercker/ruby
build:
    steps:
        # Execute the bundle install step, a step provided by wercker
        - bundle-install
        # Execute a custom script step.
        - script:
            name: middleman build
            code: bundle exec middleman build --verbose
    after-steps:
    - wouter/email-notify:
        from: alerts@wercker.com
        to: mies@wercker.com
        username: $USER
        password: $PASS
        host: smtp.gmail.com:587
deploy:
    steps:
        # Execute the heroku-deploy, heroku details can be edited
        # online at http://app.wercker.com/
        #- heroku-deploy

        # Execute the s3sync deploy step, a step provided by wercker
        - s3sync:
            key_id: $AWS_ACCESS_KEY_ID
            key_secret: $AWS_SECRET_ACCESS_KEY
            bucket_url: $AWS_BUCKET_URL
            source_dir: build/
    after-steps:
        - wouter/email-notify:
            from: alerts@wercker.com
            to: mies@wercker.com
            username: $USER
            password: $PASS
            host: smtp.gmail.com:587